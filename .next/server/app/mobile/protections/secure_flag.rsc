1:HL["/_next/static/media/2aaf0723e720e8b9-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/css/ec2c95c4a0b5aeac.css",{"as":"style"}]
0:["TmpMQv2BparyZL1Mlwt5A",[[["",{"children":[["slug","mobile/protections/secure_flag","c"],{"children":["__PAGE__?{\"slug\":[\"mobile\",\"protections\",\"secure_flag\"]}",{}]}]},"$undefined","$undefined",true],"$L3",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/ec2c95c4a0b5aeac.css","precedence":"next"}]],"$L4"]]]]
5:I{"id":2648,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","185:static/chunks/app/layout-4aadab169859256e.js"],"name":"WikiProvider","async":false}
6:I{"id":9417,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","185:static/chunks/app/layout-4aadab169859256e.js"],"name":"SearchProvider","async":false}
7:I{"id":1350,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"Navbar","async":false}
8:I{"id":7767,"chunks":["272:static/chunks/webpack-b436426dcbaf52c9.js","971:static/chunks/fd9d1056-cf2ed9b9f252c563.js","596:static/chunks/596-48ba4ae402e6d185.js"],"name":"default","async":false}
9:I{"id":7920,"chunks":["272:static/chunks/webpack-b436426dcbaf52c9.js","971:static/chunks/fd9d1056-cf2ed9b9f252c563.js","596:static/chunks/596-48ba4ae402e6d185.js"],"name":"default","async":false}
4:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Docs | Kirito"}],["$","meta","2",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","3",{"rel":"icon","href":"/logo/logo_green.png"}],["$","meta","4",{"name":"next-size-adjust"}]]
3:[["$","html",null,{"lang":"en","className":"__className_20951f","style":{"colorScheme":"dark"},"children":["$","body",null,{"className":"bg-black","children":["$","$L5",null,{"children":["$","$L6",null,{"children":[["$","$L7",null,{}],["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children",["slug","mobile/protections/secure_flag","c"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$La","notFoundStyles":[],"childProp":{"current":["$Lb",null],"segment":"__PAGE__?{\"slug\":[\"mobile\",\"protections\",\"secure_flag\"]}"},"styles":[]}],"segment":["slug","mobile/protections/secure_flag","c"]},"styles":[]}],["$","footer",null,{"className":"bg-[#111] border-y border-[#333]","children":["$","div",null,{"children":["$","div",null,{"className":"flex justify-center gap-3 items-center w-full my-8 mb-12","children":[["$","img",null,{"src":"/_next/static/media/logo_white.35709e9b.png","alt":"Logo","style":{"maxWidth":"40px","maxHeight":"100px"}}],["$","p",null,{"className":"text-xs text-[#888]","children":["Copyright © ",2023,"  ",["$","a",null,{"className":"text-blue-500 font-bold no-underline","href":"https://github.com/kiritorce","children":"Kirito"}]]}]]}]}]}]]}]}]}]}],null]
c:I{"id":6716,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"MobileSidebar","async":false}
d:I{"id":8836,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"SearchDialog","async":false}
e:I{"id":3406,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"Sidebar","async":false}
f:I{"id":183,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"Fence","async":false}
10:I{"id":7593,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"TableOfContents","async":false}
a:["$","div",null,{"className":"flex justify-center items-center text-white h-[calc(100vh-64px)]","children":[["$","h1",null,{"className":"text-2xl sm:text-3xl font-extrabold text-white tracking-tight sm:pr-6 sm:mr-6 sm:border-r sm:border-[#333]","children":"404"}],["$","h2",null,{"className":"text-lg","children":"This page could not be found."}]]}]
b:["$","main",null,{"children":[["$","$Lc",null,{}],["$","div",null,{"className":"py-10 relative md:flex md:py-10 gap-x-6 mx-auto md:flex-row max-w-screen-xl px-4 md:px-0","children":[["$","$Ld",null,{}],["$","$Le",null,{}],["$","div",null,{"className":"prose prose-invert w-full min-w-0 max-w-6xl custom-li","children":["$","article",null,{"children":[["$","h1",null,{"id":"flag-secure","children":"Flag Secure"}],["$","h2",null,{"id":"prefacio","children":"Prefácio"}],["$","p",null,{"children":["A flag ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," é uma configuração importante no Android que ajuda a proteger o conteúdo sensível da tela em aplicativos. Quando uma atividade é marcada com essa flag, o sistema operacional adota medidas de segurança adicionais para evitar que o conteúdo da tela seja capturado por meio de screenshots ou gravado em vídeos. Além disso, impede que o conteúdo seja exibido em dispositivos externos, como monitores ou projetores, que não são considerados seguros pelo sistema."]}],["$","h2",null,{"id":"importancia-da-flag-secure","children":"Importância da Flag Secure"}],["$","p",null,{"children":["A proteção do conteúdo sensível em aplicativos é crucial para garantir a privacidade e a segurança dos usuários. Ao utilizar a flag ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}],", você pode evitar que informações confidenciais, como senhas, dados bancários e informações de autenticação, sejam comprometidas. Isso é especialmente relevante em aplicativos que lidam com dados sensíveis."]}],["$","h2",null,{"id":"owasp-id","children":"OWASP ID"}],["$","p",null,{"children":["$","a",null,{"href":"https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication","children":["OWASP-MOBILE-2016 - M4: Insecure Authentication",["$","span",null,{"className":"inline-flex","children":["$","svg",null,{"data-testid":"geist-icon","fill":"none","height":"14","shapeRendering":"geometricPrecision","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"1.5","viewBox":"0 0 24 24","width":"14","className":"text-current","children":[["$","path",null,{"d":"M7 17L17 7"}],["$","path",null,{"d":"M7 7h10v10"}]]}]}]]}]}],["$","h2",null,{"id":"implementando-a-flag-secure","children":"Implementando a Flag Secure"}],["$","p",null,{"children":["Existem duas maneiras principais de implementar a ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," em um aplicativo Android:"]}],["$","ol",null,{"children":["$","li",null,{"children":["No Manifest.xml:"," ","Você pode definir o atributo ",["$","strong",null,{"children":["$","code",null,{"children":"android:windowSecure"}]}]," como ",["$","strong",null,{"children":"true"}]," no elemento ",["$","strong",null,{"children":["$","code",null,{"children":"<activity>"}]}]," do arquivo ",["$","strong",null,{"children":"Manifest.xml"}]," para todas as atividades do seu aplicativo. Dessa forma, a flag ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," será aplicada automaticamente a todas as atividades."]}]}],["$","p",null,{"children":["Exemplo ",["$","strong",null,{"children":"Manifest.xml"}],":"]}],["$","$Lf",null,{"language":"xml","children":"<activity android:name=\".MainActivity\"\n          android:windowSecure=\"true\">\n    ...\n</activity>\n"}],["$","ol",null,{"children":["$","li",null,{"children":["No código ",["$","strong",null,{"children":"Java/Kotlin"}],":"]}]}],["$","p",null,{"children":["Você pode usar o método ",["$","strong",null,{"children":["$","code",null,{"children":"setFlags()"}]}]," da classe ",["$","strong",null,{"children":["$","code",null,{"children":"Window"}]}]," para definir programaticamente a flag ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," em uma atividade específica."]}],["$","p",null,{"children":["Exemplo ",["$","strong",null,{"children":"Java"}],":"]}],["$","$Lf",null,{"language":"java","children":"getWindow().setFlags(WindowManager.LayoutParams.FLAG_SECURE, WindowManager.LayoutParams.FLAG_SECURE);\n"}],["$","p",null,{"children":["Exemplo ",["$","strong",null,{"children":"Kotlin"}],":"]}],["$","$Lf",null,{"language":"kotlin","children":"window.setFlags(WindowManager.LayoutParams.FLAG_SECURE, WindowManager.LayoutParams.FLAG_SECURE)\n"}],["$","p",null,{"children":"Normalmente, você chamaria esse método no método onCreate() da sua atividade principal."}],["$","h2",null,{"id":"bypass-da-flag-secure-com-frida-tools","children":"Bypass da Flag Secure com Frida Tools"}],["$","p",null,{"children":["É importante destacar que a ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," não é uma proteção absoluta, e algumas abordagens podem contornar essa configuração. Uma dessas abordagens envolve o uso do Frida Tools, uma ferramenta para manipulação e instrumentação de aplicativos Android."]}],["$","p",null,{"children":["O script abaixo demonstra como realizar o bypass da ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," usando o Frida Tools:"]}],["$","$Lf",null,{"language":"js","children":"Java.perform(function() {\n    var surface_view = Java.use('android.view.SurfaceView');\n\n    var set_secure = surface_view.setSecure.overload('boolean');\n\n    set_secure.implementation = function(flag){\n        console.log(\"setSecure() flag called with args: \" + flag); \n        set_secure.call(false);\n    };\n\n    var window = Java.use('android.view.Window');\n    var set_flags = window.setFlags.overload('int', 'int');\n\n    var window_manager = Java.use('android.view.WindowManager');\n    var layout_params = Java.use('android.view.WindowManager$LayoutParams');\n\n    set_flags.implementation = function(flags, mask){\n        console.log(\"flag secure: \" + layout_params.FLAG_SECURE.value);\n\n        console.log(\"before setflags called  flags:  \"+ flags);\n        flags =(flags.value & ~layout_params.FLAG_SECURE.value);\n        console.log(\"after setflags called  flags:  \"+ flags);\n\n        set_flags.call(this, flags, mask);\n    };\n});\n"}],["$","p",null,{"children":["Essa abordagem demonstra uma possível vulnerabilidade em relação à ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}],", mas é importante ressaltar que a proteção oferecida por essa configuração é eficaz na maioria dos casos e desencoraja a captura e o compartilhamento não autorizados de conteúdo sensível."]}],["$","h2",null,{"id":"praticas-recomendadas-e-mitigacao","children":"Práticas Recomendadas e Mitigação"}],["$","p",null,{"children":["Para mitigar as vulnerabilidades relacionadas à ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," e garantir uma proteção adequada do conteúdo sensível, aqui estão algumas práticas recomendadas:"]}],["$","ul",null,{"children":[["$","li",null,{"children":["Verifique se a configuração global ",["$","strong",null,{"children":["$","code",null,{"children":"secure"}]}]," está definida como verdadeira. Isso pode ser feito usando o método ",["$","strong",null,{"children":["$","code",null,{"children":"Secure.getInt()"}]}]," para obter o valor da configuração e verificar se está definido como ",["$","strong",null,{"children":"1"}],";"]}],["$","li",null,{"children":["Monitore as propriedades do sistema, como ",["$","strong",null,{"children":["$","code",null,{"children":"secure"}]}]," e ",["$","strong",null,{"children":["$","code",null,{"children":"ro.debuggable"}]}],", para verificar se estão definidas corretamente. Valores incorretos podem indicar que o ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," não está configurado adequadamente;"]}],["$","li",null,{"children":["Verifique se a assinatura do pacote do aplicativo corresponde à assinatura esperada. Se a assinatura for diferente, isso pode indicar que o aplicativo foi modificado para desativar o ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}],";"]}],["$","li",null,{"children":["Analise o arquivo xml do aplicativo para verificar se a flag ",["$","strong",null,{"children":["$","code",null,{"children":"android:debuggable"}]}]," está definida como ",["$","strong",null,{"children":"false"}],". A definição dessa flag como ",["$","strong",null,{"children":"true"}]," pode indicar uma configuração insegura;"]}],["$","li",null,{"children":"Monitore o comportamento do aplicativo em tempo de execução em busca de comportamentos incomuns, como o uso de APIs de depuração, acesso não autorizado a recursos protegidos ou acesso a informações sensíveis;"}],["$","li",null,{"children":"Implemente testes de integridade no aplicativo para detectar modificações ou manipulações no código em tempo de execução. Isso pode envolver a verificação de hashes de arquivos relevantes ou a comparação de versões do aplicativo."}]]}],["$","h2",null,{"id":"conclusao","children":"Conclusão"}],["$","p",null,{"children":["A flag ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," é uma medida de segurança essencial para proteger o conteúdo sensível em aplicativos Android. Implementar essa configuração adequadamente e adotar as práticas recomendadas de mitigação ajudará a garantir a privacidade e a segurança dos usuários. No entanto, é importante estar ciente de que nenhuma proteção é absoluta, e abordagens como o uso do Frida Tools podem contornar a ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," em certos casos. Portanto, é fundamental adotar uma abordagem abrangente de segurança, combinando várias camadas de proteção para garantir a integridade do aplicativo e a privacidade dos usuários."]}],["$","h2",null,{"id":"referencias","children":"Referências"}],["$","p",null,{"children":["$","a",null,{"href":"https://developer.android.com/topic/security/best-practices?hl=pt-br","children":[["Android - Práticas recomendadas para segurança de ",["$","em",null,{"children":"apps"}]],["$","span",null,{"className":"inline-flex","children":["$","svg",null,{"data-testid":"geist-icon","fill":"none","height":"14","shapeRendering":"geometricPrecision","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"1.5","viewBox":"0 0 24 24","width":"14","className":"text-current","children":[["$","path",null,{"d":"M7 17L17 7"}],["$","path",null,{"d":"M7 7h10v10"}]]}]}]]}]}],["$","p",null,{"children":["$","a",null,{"href":"https://developer.android.com/reference/android/view/WindowManager.LayoutParams#FLAG_LAYOUT_IN_SCREEN","children":["Android - WindowManager.LayoutParams",["$","span",null,{"className":"inline-flex","children":["$","svg",null,{"data-testid":"geist-icon","fill":"none","height":"14","shapeRendering":"geometricPrecision","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"1.5","viewBox":"0 0 24 24","width":"14","className":"text-current","children":[["$","path",null,{"d":"M7 17L17 7"}],["$","path",null,{"d":"M7 7h10v10"}]]}]}]]}]}],["$","p",null,{"children":["$","a",null,{"href":"https://github.com/commonsguy/cwac-security/blob/master/docs/FLAGSECURE.md","children":["GitHub - About the FLAG_SECURE Child Window Issue",["$","span",null,{"className":"inline-flex","children":["$","svg",null,{"data-testid":"geist-icon","fill":"none","height":"14","shapeRendering":"geometricPrecision","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"1.5","viewBox":"0 0 24 24","width":"14","className":"text-current","children":[["$","path",null,{"d":"M7 17L17 7"}],["$","path",null,{"d":"M7 7h10v10"}]]}]}]]}]}],["$","p",null,{"children":["$","a",null,{"href":"http://www.java2s.com/example/android/user-interface/set-flag-secure.html","children":["Java2s - set Flag Secure - Android User Interface",["$","span",null,{"className":"inline-flex","children":["$","svg",null,{"data-testid":"geist-icon","fill":"none","height":"14","shapeRendering":"geometricPrecision","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"1.5","viewBox":"0 0 24 24","width":"14","className":"text-current","children":[["$","path",null,{"d":"M7 17L17 7"}],["$","path",null,{"d":"M7 7h10v10"}]]}]}]]}]}]]}]}],["$","$L10",null,{"headings":[{"id":"flag-secure","title":"Flag Secure","children":[]},{"id":"prefacio","title":"Prefácio","children":[]},{"id":"importancia-da-flag-secure","title":"Importância da Flag Secure","children":[]},{"id":"owasp-id","title":"OWASP ID","children":[]},{"id":"implementando-a-flag-secure","title":"Implementando a Flag Secure","children":[]},{"id":"bypass-da-flag-secure-com-frida-tools","title":"Bypass da Flag Secure com Frida Tools","children":[]},{"id":"praticas-recomendadas-e-mitigacao","title":"Práticas Recomendadas e Mitigação","children":[]},{"id":"conclusao","title":"Conclusão","children":[]},{"id":"referencias","title":"Referências","children":[]}]}]]}]]}]
