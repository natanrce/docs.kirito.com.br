1:HL["/_next/static/media/2aaf0723e720e8b9-s.p.woff2",{"as":"font","type":"font/woff2"}]
2:HL["/_next/static/css/ec2c95c4a0b5aeac.css",{"as":"style"}]
0:["TmpMQv2BparyZL1Mlwt5A",[[["",{"children":[["slug","labs/mobile/secure_app","c"],{"children":["__PAGE__?{\"slug\":[\"labs\",\"mobile\",\"secure_app\"]}",{}]}]},"$undefined","$undefined",true],"$L3",[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/ec2c95c4a0b5aeac.css","precedence":"next"}]],"$L4"]]]]
5:I{"id":2648,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","185:static/chunks/app/layout-4aadab169859256e.js"],"name":"WikiProvider","async":false}
6:I{"id":9417,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","185:static/chunks/app/layout-4aadab169859256e.js"],"name":"SearchProvider","async":false}
7:I{"id":1350,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"Navbar","async":false}
8:I{"id":7767,"chunks":["272:static/chunks/webpack-b436426dcbaf52c9.js","971:static/chunks/fd9d1056-cf2ed9b9f252c563.js","596:static/chunks/596-48ba4ae402e6d185.js"],"name":"default","async":false}
9:I{"id":7920,"chunks":["272:static/chunks/webpack-b436426dcbaf52c9.js","971:static/chunks/fd9d1056-cf2ed9b9f252c563.js","596:static/chunks/596-48ba4ae402e6d185.js"],"name":"default","async":false}
4:[["$","meta","0",{"charSet":"utf-8"}],["$","title","1",{"children":"Docs | Kirito"}],["$","meta","2",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","link","3",{"rel":"icon","href":"/logo/logo_green.png"}],["$","meta","4",{"name":"next-size-adjust"}]]
3:[["$","html",null,{"lang":"en","className":"__className_20951f","style":{"colorScheme":"dark"},"children":["$","body",null,{"className":"bg-black","children":["$","$L5",null,{"children":["$","$L6",null,{"children":[["$","$L7",null,{}],["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined","childProp":{"current":["$","$L8",null,{"parallelRouterKey":"children","segmentPath":["children",["slug","labs/mobile/secure_app","c"],"children"],"error":"$undefined","errorStyles":"$undefined","loading":"$undefined","loadingStyles":"$undefined","hasLoading":false,"template":["$","$L9",null,{}],"templateStyles":"$undefined","notFound":"$La","notFoundStyles":[],"childProp":{"current":["$Lb",null],"segment":"__PAGE__?{\"slug\":[\"labs\",\"mobile\",\"secure_app\"]}"},"styles":[]}],"segment":["slug","labs/mobile/secure_app","c"]},"styles":[]}],["$","footer",null,{"className":"bg-[#111] border-y border-[#333]","children":["$","div",null,{"children":["$","div",null,{"className":"flex justify-center gap-3 items-center w-full my-8 mb-12","children":[["$","img",null,{"src":"/_next/static/media/logo_white.35709e9b.png","alt":"Logo","style":{"maxWidth":"40px","maxHeight":"100px"}}],["$","p",null,{"className":"text-xs text-[#888]","children":["Copyright © ",2023,"  ",["$","a",null,{"className":"text-blue-500 font-bold no-underline","href":"https://github.com/kiritorce","children":"Kirito"}]]}]]}]}]}]]}]}]}]}],null]
c:I{"id":6716,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"MobileSidebar","async":false}
d:I{"id":8836,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"SearchDialog","async":false}
e:I{"id":3406,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"Sidebar","async":false}
f:I{"id":183,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"Fence","async":false}
10:I{"id":7593,"chunks":["336:static/chunks/336-80894123ddb06d86.js","648:static/chunks/648-20ce7a2bd0908fd0.js","877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js"],"name":"TableOfContents","async":false}
a:["$","div",null,{"className":"flex justify-center items-center text-white h-[calc(100vh-64px)]","children":[["$","h1",null,{"className":"text-2xl sm:text-3xl font-extrabold text-white tracking-tight sm:pr-6 sm:mr-6 sm:border-r sm:border-[#333]","children":"404"}],["$","h2",null,{"className":"text-lg","children":"This page could not be found."}]]}]
b:["$","main",null,{"children":[["$","$Lc",null,{}],["$","div",null,{"className":"py-10 relative md:flex md:py-10 gap-x-6 mx-auto md:flex-row max-w-screen-xl px-4 md:px-0","children":[["$","$Ld",null,{}],["$","$Le",null,{}],["$","div",null,{"className":"prose prose-invert w-full min-w-0 max-w-6xl custom-li","children":["$","article",null,{"children":[["$","h1",null,{"id":"prefacio","children":"Prefácio"}],["$","p",null,{"children":["O objetivo deste laboratório é colocar em prática os conceitos destacados na seção de proteções ",["$","a",null,{"href":"https://docs.kirito.com.br/mobile/secure_flag","children":["Flag Secure",["$","span",null,{"className":"inline-flex","children":["$","svg",null,{"data-testid":"geist-icon","fill":"none","height":"14","shapeRendering":"geometricPrecision","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"1.5","viewBox":"0 0 24 24","width":"14","className":"text-current","children":[["$","path",null,{"d":"M7 17L17 7"}],["$","path",null,{"d":"M7 7h10v10"}]]}]}]]}],". Ao longo deste laboratório, investigaremos de perto o impacto da vulnerabilidade da secure flag no contexto do sistema operacional Android. Você terá a oportunidade de observar como a falta de segurança pode comprometer a integridade e a confidencialidade dos dados em um dispositivo Android."]}],["$","p",null,{"children":"Ressaltamos que este laboratório destina-se exclusivamente a fins educacionais e para conscientização sobre as ameaças potenciais relacionadas à segurança do Android. Ao explorar essa vulnerabilidade em um ambiente controlado, esperamos fornecer uma compreensão mais aprofundada dos desafios enfrentados pelos desenvolvedores e usuários na proteção de dispositivos Android contra ataques maliciosos."}],["$","h2",null,{"id":"requisitos","children":"Requisitos"}],["$","p",null,{"children":"Para a realização deste laboratório, foi desenvolvido um aplicativo específico para estudos, que pode ser adquirido no seguinte link:"}],["$","p",null,{"children":["$","a",null,{"href":"https://github.com/kiritorce/mobile-hacking-laboratory","children":["Secure App",["$","span",null,{"className":"inline-flex","children":["$","svg",null,{"data-testid":"geist-icon","fill":"none","height":"14","shapeRendering":"geometricPrecision","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"1.5","viewBox":"0 0 24 24","width":"14","className":"text-current","children":[["$","path",null,{"d":"M7 17L17 7"}],["$","path",null,{"d":"M7 7h10v10"}]]}]}]]}]}],["$","p",null,{"children":"Antes de prosseguir com os testes, certifique-se de que o dispositivo esteja configurado com o API Level 30 para garantir o correto funcionamento de todas as etapas do laboratório."}],["$","h2",null,{"id":"instalacao-e-fluxo-padrao","children":"Instalação e fluxo padrão"}],["$","p",null,{"children":"Antes de realizar qualquer processo de root no dispositivo ou iniciar o servidor Frida, é importante entender o comportamento padrão do aplicativo e verificar suas funcionalidades."}],["$","ol",null,{"children":["$","li",null,{"children":"Instale o aplicativo a ser testado e verifique o seu funcionamento normal."}]}],["$","$Lf",null,{"language":"jsx","children":"adb install secureapp.apk\n"}],["$","p",null,{"children":["$","img",null,{"src":"/mobile/labs_mobile/lab01_secureapp/flag_img_1.png","alt":"Lab01-SecureApp_img1"}]}],["$","ol",null,{"children":["$","li",null,{"children":"Tente tirar uma screenshot da tela ou colocar o aplicativo em segundo plano (background)."}]}],["$","$Lf",null,{"language":"jsx","children":"adb shell screencap -p /sdcard/screen.png\n"}],["$","$Lf",null,{"language":"jsx","children":"adb exec-out screencap -p > screen.png\n"}],["$","p",null,{"children":["$","img",null,{"src":"/mobile/labs_mobile/lab01_secureapp/flag_img_2.png","alt":"Lab01-SecureApp_img2"}]}],["$","p",null,{"children":["Verifique que a captura é exibida com 0 bytes e as informações desaparecem ao serem enviadas para o plano de fundo, o que indica que a proteção ",["$","strong",null,{"children":["$","code",null,{"children":"FLAG_SECURE"}]}]," está operando adequadamente."]}],["$","blockquote",null,{"children":["$","p",null,{"children":["A implementação da configuração FLAG_SECURE não é tão eficiente quanto gostaríamos, pois pode ser facilmente burlada com o uso de scripts encontrados na internet. A seguir, serão apresentadas formas de realizar essa ação utilizando o Frida Tools. Vamos utilizar o script padrão do Frida, que pode ser encontrado no seguinte repositório do GitHub: ",["$","a",null,{"href":"https://gist.github.com/su-vikas/36410f67c9e0127961ae344010c4c0ef","children":["FRIDA script for bypassing Android FLAG_SECURE",["$","span",null,{"className":"inline-flex","children":["$","svg",null,{"data-testid":"geist-icon","fill":"none","height":"14","shapeRendering":"geometricPrecision","stroke":"currentColor","strokeLinecap":"round","strokeLinejoin":"round","strokeWidth":"1.5","viewBox":"0 0 24 24","width":"14","className":"text-current","children":[["$","path",null,{"d":"M7 17L17 7"}],["$","path",null,{"d":"M7 7h10v10"}]]}]}]]}]]}]}],["$","h2",null,{"id":"script-flag-secure-bypass","children":"Script Flag Secure Bypass"}],["$","$Lf",null,{"language":"js","children":"Java.perform(function() {\n    var surface_view = Java.use('android.view.SurfaceView');\n\n    var set_secure = surface_view.setSecure.overload('boolean');\n\n    set_secure.implementation = function(flag){\n        console.log(\"setSecure() flag called with args: \" + flag); \n        set_secure.call(false);\n    };\n\n    var window = Java.use('android.view.Window');\n    var set_flags = window.setFlags.overload('int', 'int');\n\n    var window_manager = Java.use('android.view.WindowManager');\n    var layout_params = Java.use('android.view.WindowManager$LayoutParams');\n\n    set_flags.implementation = function(flags, mask){\n        //console.log(Object.getOwnPropertyNames(window.__proto__).join('\\n'));\n        console.log(\"flag secure: \" + layout_params.FLAG_SECURE.value);\n\n        console.log(\"before setflags called  flags:  \"+ flags);\n        flags =(flags.value & ~layout_params.FLAG_SECURE.value);\n        console.log(\"after setflags called  flags:  \"+ flags);\n\n        set_flags.call(this, flags, mask);\n    };\n});\n"}],["$","h2",null,{"id":"processo-de-bypass","children":"Processo de Bypass"}],["$","ol",null,{"children":["$","li",null,{"children":"Após entender o funcionamento normal do aplicativo e identificar a proteção, é necessário fazer o root do dispositivo e iniciar o servidor Frida."}]}],["$","$Lf",null,{"language":"jsx","children":"adb root\nadb shell /data/local/tmp/frida-server-16.0.10-android-arm64 &\n"}],["$","ol",null,{"children":["$","li",null,{"children":"A partir desse ponto, basta anexar o script ao aplicativo e realizar a captura de tela."}]}],["$","$Lf",null,{"language":"jsx","children":"frida -U -f com.secureapp -l secureflag.js --pause\n"}],["$","p",null,{"children":["$","img",null,{"src":"/mobile/labs_mobile/lab01_secureapp/flag_img_3.png","alt":"Lab01-SecureApp_img3"}]}],["$","p",null,{"children":["$","img",null,{"src":"/mobile/labs_mobile/lab01_secureapp/flag_img_4.png","alt":"Lab01-SecureApp_img4"}]}]]}]}],["$","$L10",null,{"headings":[{"id":"prefacio","title":"Prefácio","children":[]},{"id":"requisitos","title":"Requisitos","children":[]},{"id":"instalacao-e-fluxo-padrao","title":"Instalação e fluxo padrão","children":[]},{"id":"script-flag-secure-bypass","title":"Script Flag Secure Bypass","children":[]},{"id":"processo-de-bypass","title":"Processo de Bypass","children":[]}]}]]}]]}]
