<!DOCTYPE html><html lang="en" class="__className_20951f" style="color-scheme:dark"><head><meta charSet="utf-8"/><link rel="preload" as="font" href="/_next/static/media/2aaf0723e720e8b9-s.p.woff2" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/ec2c95c4a0b5aeac.css" data-precedence="next"/><link rel="preload" href="/_next/static/chunks/webpack-b436426dcbaf52c9.js" as="script"/><link rel="preload" href="/_next/static/chunks/fd9d1056-cf2ed9b9f252c563.js" as="script"/><link rel="preload" href="/_next/static/chunks/596-48ba4ae402e6d185.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-app-a51e70cdc63efed3.js" as="script"/><title>Docs | Kirito</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="icon" href="/logo/logo_green.png"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="bg-black"><header class="h-[64px] sticky top-0 z-50 flex items-center md:px-4 pr-4 w-full antialiased backdrop-blur-sm backdrop-saturate-200 bg-black/50 border-b border-[#333]"><nav class="mb-[-1px] h-full flex justify-between items-center w-full max-w-screen-xl px-4 mx-auto"><a href="/"><img src="/_next/static/media/logo_white.35709e9b.png" alt="Logo" style="max-width:40px;max-height:100px"/></a><div class="flex gap-6"><a class="text-sm relative transition-colors duration-200 text-[#888] hover:text-[#fafafa]" href="/">Home</a><a class="text-sm relative transition-colors duration-200 text-[#888] hover:text-[#fafafa]" href="https://github.com/kiritorce/">Github<svg aria-hidden="true" class="absolute top-[0.5px] right-[-10px] text-[#444]" height="7" viewBox="0 0 6 6" width="7"><path d="M1.25215 5.54731L0.622742 4.9179L3.78169 1.75597H1.3834L1.38936 0.890915H5.27615V4.78069H4.40513L4.41109 2.38538L1.25215 5.54731Z" fill="currentColor"></path></svg></a><a class="text-sm relative transition-colors duration-200 text-[#888] hover:text-[#fafafa]" href="https://discord.gg/vfMrNRtPze">Community<svg aria-hidden="true" class="absolute top-[0.5px] right-[-10px] text-[#444]" height="7" viewBox="0 0 6 6" width="7"><path d="M1.25215 5.54731L0.622742 4.9179L3.78169 1.75597H1.3834L1.38936 0.890915H5.27615V4.78069H4.40513L4.41109 2.38538L1.25215 5.54731Z" fill="currentColor"></path></svg></a></div><button class="hidden md:flex justify-between items-center py-1.5 px-2 text-sm whitespace-nowrap bg-[#1f1f1f] rounded-md text-neutral-400">Search documentation...<kbd class="h-[22px] leading-[22px] rounded text-xs text-[#a1a1a1] bg-[#0a0a0a] border border-white/10 ml-4 p-[0_6px]">⌘ K</kbd></button><button class="md:hidden"><svg fill="none" height="22" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="22"><path d="M11 17.25a6.25 6.25 0 110-12.5 6.25 6.25 0 010 12.5z"></path><path d="M16 16l4.5 4.5"></path></svg></button></nav></header><main><div class="fixed w-full top-[64px] z-10 md:hidden py-3 px-4 border-b border-[#333] backdrop-blur-sm backdrop-saturate-200 antialiased bg-black"><div class="flex flex-col justify-between"><button class="flex items-center gap-1" type="button"><svg fill="none" height="16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16" class="text-current transition-transform"><path d="M9 18l6-6-6-6"></path></svg> <span>Menu</span></button></div></div><div class="py-10 relative md:flex md:py-10 gap-x-6 mx-auto md:flex-row max-w-screen-xl px-4 md:px-0"><form noValidate="" role="search" action=""></form><aside class="w-[284px] shrink-0 hidden md:block"><div class="sticky top-[121px]"><button class="flex justify-between items-center w-full hover:bg-[#1f1f1f] hover:cursor-pointer rounded-md pr-2" id="headlessui-listbox-button-:R359mmja:" type="button" aria-haspopup="listbox" aria-expanded="false" data-headlessui-state=""><div class="flex flex-col gap-6 p-2"><div class="flex items-center gap-2"><div class="text-[#0072f5] border rounded-md p-1.5 border-[#0d3868] border bg-gradient-to-b from-black to-[#0d3868]"><svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="24" style="color:currentcolor;width:20px;height:20px"><path d="M13 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V9z"></path><path d="M13 2v7h7"></path></svg></div><div><h2 class="text-left text-sm font-medium">Mobile Hacking Wiki</h2><p class="text-gray-400 text-xs font-normal">Android mobile hacking resources.</p></div></div></div><svg fill="none" height="16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16" class="text-current transition-transform rotate-90"><path d="M9 18l6-6-6-6"></path></svg></button><div class="h-[calc(100vh-130px)] overflow-y-auto"><div data-headlessui-state=""><ul><li class="relative mt-6"><button class="flex justify-between w-full text-left mb-[4px] px-2 text-sm font-medium text-white" id="headlessui-disclosure-button-:R4p9mmja:" type="button" aria-expanded="false" data-headlessui-state="">Setup ⚙️<svg fill="none" height="16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16" class="text-current transition-transform"><path d="M9 18l6-6-6-6"></path></svg></button></li></ul></div><div data-headlessui-state=""><ul><li class="relative mt-6"><button class="flex justify-between w-full text-left mb-[4px] px-2 text-sm font-medium text-white" id="headlessui-disclosure-button-:R599mmja:" type="button" aria-expanded="false" data-headlessui-state="">Commands Trick 📱<svg fill="none" height="16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16" class="text-current transition-transform"><path d="M9 18l6-6-6-6"></path></svg></button></li></ul></div><div data-headlessui-state=""><ul><li class="relative mt-6"><button class="flex justify-between w-full text-left mb-[4px] px-2 text-sm font-medium text-white" id="headlessui-disclosure-button-:R5p9mmja:" type="button" aria-expanded="false" data-headlessui-state="">OWASP Mobile Top 10 - 2023 📚<svg fill="none" height="16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16" class="text-current transition-transform"><path d="M9 18l6-6-6-6"></path></svg></button></li></ul></div><div data-headlessui-state=""><ul><li class="relative mt-6"><button class="flex justify-between w-full text-left mb-[4px] px-2 text-sm font-medium text-white" id="headlessui-disclosure-button-:R699mmja:" type="button" aria-expanded="false" data-headlessui-state="">Pentest (stage)<svg fill="none" height="16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16" class="text-current transition-transform"><path d="M9 18l6-6-6-6"></path></svg></button></li></ul></div><div data-headlessui-state="open"><ul><li class="relative mt-6"><button class="flex justify-between w-full text-left mb-[4px] px-2 text-sm font-medium text-white" id="headlessui-disclosure-button-:R6p9mmja:" type="button" aria-expanded="true" data-headlessui-state="open">Proteções 🔒<svg fill="none" height="16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16" class="text-current transition-transform rotate-90"><path d="M9 18l6-6-6-6"></path></svg></button><ul class="mb-8" id="headlessui-disclosure-panel-:Rap9mmja:" data-headlessui-state="open"><li class="my-1.5"><a class="flex w-full relative cursor-pointer items-center justify-between rounded-md pl-2 py-1 text-left text-sm font-medium text-blue-600 dark:text-blue-500" href="/mobile/protections/secure_flag">Flag Secure</a></li><li class="my-1.5"><a class="flex w-full relative cursor-pointer items-center justify-between rounded-md pl-2 py-1 text-left text-sm text-[#888] hover:text-[#fafafa]" href="/mobile/protections/emulation_detection">Emulation Detection</a></li><li class="my-1.5"><a class="flex w-full relative cursor-pointer items-center justify-between rounded-md pl-2 py-1 text-left text-sm text-[#888] hover:text-[#fafafa]" href="/mobile/protections/frida_detection">Frida Detection</a></li><li class="my-1.5"><a class="flex w-full relative cursor-pointer items-center justify-between rounded-md pl-2 py-1 text-left text-sm text-[#888] hover:text-[#fafafa]" href="/mobile/protections/root_detection">Root Detection</a></li><li class="my-1.5"><a class="flex w-full relative cursor-pointer items-center justify-between rounded-md pl-2 py-1 text-left text-sm text-[#888] hover:text-[#fafafa]" href="/mobile/protections/ssl_tls_pinning">SSL/TLS Pinning</a></li><li class="my-1.5"><a class="flex w-full relative cursor-pointer items-center justify-between rounded-md pl-2 py-1 text-left text-sm text-[#888] hover:text-[#fafafa]" href="/mobile/protections/insecure_data_storage">Insecure Data Storage</a></li><li class="my-1.5"><a class="flex w-full relative cursor-pointer items-center justify-between rounded-md pl-2 py-1 text-left text-sm text-[#888] hover:text-[#fafafa]" href="/mobile/protections/sql_injection">SQL Injection</a></li></ul></li></ul></div><div data-headlessui-state=""><ul><li class="relative mt-6"><button class="flex justify-between w-full text-left mb-[4px] px-2 text-sm font-medium text-white" id="headlessui-disclosure-button-:R799mmja:" type="button" aria-expanded="false" data-headlessui-state="">Laboratory 🔬<svg fill="none" height="16" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="16" class="text-current transition-transform"><path d="M9 18l6-6-6-6"></path></svg></button></li></ul></div></div></div></aside><div class="prose prose-invert w-full min-w-0 max-w-6xl custom-li"><article><h1 id="flag-secure">Flag Secure</h1><h2 id="prefacio">Prefácio</h2><p>A flag <strong><code>FLAG_SECURE</code></strong> é uma configuração importante no Android que ajuda a proteger o conteúdo sensível da tela em aplicativos. Quando uma atividade é marcada com essa flag, o sistema operacional adota medidas de segurança adicionais para evitar que o conteúdo da tela seja capturado por meio de screenshots ou gravado em vídeos. Além disso, impede que o conteúdo seja exibido em dispositivos externos, como monitores ou projetores, que não são considerados seguros pelo sistema.</p><h2 id="importancia-da-flag-secure">Importância da Flag Secure</h2><p>A proteção do conteúdo sensível em aplicativos é crucial para garantir a privacidade e a segurança dos usuários. Ao utilizar a flag <strong><code>FLAG_SECURE</code></strong>, você pode evitar que informações confidenciais, como senhas, dados bancários e informações de autenticação, sejam comprometidas. Isso é especialmente relevante em aplicativos que lidam com dados sensíveis.</p><h2 id="owasp-id">OWASP ID</h2><p><a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication">OWASP-MOBILE-2016 - M4: Insecure Authentication<span class="inline-flex"><svg data-testid="geist-icon" fill="none" height="14" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="14" class="text-current"><path d="M7 17L17 7"></path><path d="M7 7h10v10"></path></svg></span></a></p><h2 id="implementando-a-flag-secure">Implementando a Flag Secure</h2><p>Existem duas maneiras principais de implementar a <strong><code>FLAG_SECURE</code></strong> em um aplicativo Android:</p><ol><li>No Manifest.xml:<!-- --> <!-- -->Você pode definir o atributo <strong><code>android:windowSecure</code></strong> como <strong>true</strong> no elemento <strong><code>&lt;activity&gt;</code></strong> do arquivo <strong>Manifest.xml</strong> para todas as atividades do seu aplicativo. Dessa forma, a flag <strong><code>FLAG_SECURE</code></strong> será aplicada automaticamente a todas as atividades.</li></ol><p>Exemplo <strong>Manifest.xml</strong>:</p><div class="not-prose"><div class="group relative my-4 rounded-lg border border-[#2e2e2e]"><pre class="py-5 text-[#EAEAEA] bg-[#0A0A0A] border-[#2e2e2e] rounded-lg overflow-auto"><code><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">1</span><span class="token tag punctuation">&lt;</span><span class="token tag">activity</span><span class="token tag"> </span><span class="token tag attr-name namespace">android:</span><span class="token tag attr-name">name</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">.MainActivity</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">2</span><span class="token tag">          </span><span class="token tag attr-name namespace">android:</span><span class="token tag attr-name">windowSecure</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">true</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">3</span><span class="token plain">    ...</span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">4</span><span class="token plain"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">activity</span><span class="token tag punctuation">&gt;</span>
</span></code></pre><button class="absolute top-3.5 right-3.5 overflow-hidden rounded-[5px] flex justify-center items-center w-8 h-8 font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 hover:bg-[#1f1f1f] hover:text-[#a0a0a0]"><svg fill="none" height="20" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="20" class="pointer-events-none flex items-center gap-0.5 transition duration-300"><path d="M6 17C4.89543 17 4 16.1046 4 15V5C4 3.89543 4.89543 3 6 3H13C13.7403 3 14.3866 3.4022 14.7324 4M11 21H18C19.1046 21 20 20.1046 20 19V9C20 7.89543 19.1046 7 18 7H11C9.89543 7 9 7.89543 9 9V19C9 20.1046 9.89543 21 11 21Z"></path></svg><svg fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="20" class="pointer-events-none flex items-center absolute transition duration-300 translate-y-1.5 opacity-0"><path d="M20 6L9 17l-5-5"></path></svg></button></div></div><ol><li>No código <strong>Java/Kotlin</strong>:</li></ol><p>Você pode usar o método <strong><code>setFlags()</code></strong> da classe <strong><code>Window</code></strong> para definir programaticamente a flag <strong><code>FLAG_SECURE</code></strong> em uma atividade específica.</p><p>Exemplo <strong>Java</strong>:</p><div class="not-prose"><div class="group relative my-4 rounded-lg border border-[#2e2e2e]"><pre class="py-5 text-[#EAEAEA] bg-[#0A0A0A] border-[#2e2e2e] rounded-lg overflow-auto"><code><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">1</span><span class="token plain">getWindow().setFlags(WindowManager.LayoutParams.FLAG_SECURE, WindowManager.LayoutParams.FLAG_SECURE);</span>
</span></code></pre><button class="absolute top-3.5 right-3.5 overflow-hidden rounded-[5px] flex justify-center items-center w-8 h-8 font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 hover:bg-[#1f1f1f] hover:text-[#a0a0a0]"><svg fill="none" height="20" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="20" class="pointer-events-none flex items-center gap-0.5 transition duration-300"><path d="M6 17C4.89543 17 4 16.1046 4 15V5C4 3.89543 4.89543 3 6 3H13C13.7403 3 14.3866 3.4022 14.7324 4M11 21H18C19.1046 21 20 20.1046 20 19V9C20 7.89543 19.1046 7 18 7H11C9.89543 7 9 7.89543 9 9V19C9 20.1046 9.89543 21 11 21Z"></path></svg><svg fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="20" class="pointer-events-none flex items-center absolute transition duration-300 translate-y-1.5 opacity-0"><path d="M20 6L9 17l-5-5"></path></svg></button></div></div><p>Exemplo <strong>Kotlin</strong>:</p><div class="not-prose"><div class="group relative my-4 rounded-lg border border-[#2e2e2e]"><pre class="py-5 text-[#EAEAEA] bg-[#0A0A0A] border-[#2e2e2e] rounded-lg overflow-auto"><code><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">1</span><span class="token plain">window</span><span class="token punctuation">.</span><span class="token function" style="color:#52a9ff">setFlags</span><span class="token punctuation">(</span><span class="token plain">WindowManager</span><span class="token punctuation">.</span><span class="token plain">LayoutParams</span><span class="token punctuation">.</span><span class="token plain">FLAG_SECURE</span><span class="token punctuation">,</span><span class="token plain"> WindowManager</span><span class="token punctuation">.</span><span class="token plain">LayoutParams</span><span class="token punctuation">.</span><span class="token plain">FLAG_SECURE</span><span class="token punctuation">)</span>
</span></code></pre><button class="absolute top-3.5 right-3.5 overflow-hidden rounded-[5px] flex justify-center items-center w-8 h-8 font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 hover:bg-[#1f1f1f] hover:text-[#a0a0a0]"><svg fill="none" height="20" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="20" class="pointer-events-none flex items-center gap-0.5 transition duration-300"><path d="M6 17C4.89543 17 4 16.1046 4 15V5C4 3.89543 4.89543 3 6 3H13C13.7403 3 14.3866 3.4022 14.7324 4M11 21H18C19.1046 21 20 20.1046 20 19V9C20 7.89543 19.1046 7 18 7H11C9.89543 7 9 7.89543 9 9V19C9 20.1046 9.89543 21 11 21Z"></path></svg><svg fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="20" class="pointer-events-none flex items-center absolute transition duration-300 translate-y-1.5 opacity-0"><path d="M20 6L9 17l-5-5"></path></svg></button></div></div><p>Normalmente, você chamaria esse método no método onCreate() da sua atividade principal.</p><h2 id="bypass-da-flag-secure-com-frida-tools">Bypass da Flag Secure com Frida Tools</h2><p>É importante destacar que a <strong><code>FLAG_SECURE</code></strong> não é uma proteção absoluta, e algumas abordagens podem contornar essa configuração. Uma dessas abordagens envolve o uso do Frida Tools, uma ferramenta para manipulação e instrumentação de aplicativos Android.</p><p>O script abaixo demonstra como realizar o bypass da <strong><code>FLAG_SECURE</code></strong> usando o Frida Tools:</p><div class="not-prose"><div class="group relative my-4 rounded-lg border border-[#2e2e2e]"><pre class="py-5 text-[#EAEAEA] bg-[#0A0A0A] border-[#2e2e2e] rounded-lg overflow-auto"><code><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">1</span><span class="token maybe-class-name">Java</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">perform</span><span class="token punctuation">(</span><span class="token keyword" style="color:#f76191">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">2</span><span class="token plain">    </span><span class="token keyword" style="color:#f76191">var</span><span class="token plain"> surface_view </span><span class="token operator" style="color:#f76191">=</span><span class="token plain"> </span><span class="token maybe-class-name">Java</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">use</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&#x27;android.view.SurfaceView&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">3</span><span class="token plain" style="display:inline-block">
</span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">4</span><span class="token plain">    </span><span class="token keyword" style="color:#f76191">var</span><span class="token plain"> set_secure </span><span class="token operator" style="color:#f76191">=</span><span class="token plain"> surface_view</span><span class="token punctuation">.</span><span class="token property-access">setSecure</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">overload</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&#x27;boolean&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">5</span><span class="token plain" style="display:inline-block">
</span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">6</span><span class="token plain">    set_secure</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access" style="color:#52a9ff">implementation</span><span class="token plain"> </span><span class="token operator" style="color:#f76191">=</span><span class="token plain"> </span><span class="token keyword" style="color:#f76191">function</span><span class="token punctuation">(</span><span class="token parameter">flag</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">7</span><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">log</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&quot;setSecure() flag called with args: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#f76191">+</span><span class="token plain"> flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"> </span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">8</span><span class="token plain">        set_secure</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">call</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">9</span><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">10</span><span class="token plain" style="display:inline-block">
</span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">11</span><span class="token plain">    </span><span class="token keyword" style="color:#f76191">var</span><span class="token plain"> </span><span class="token dom variable">window</span><span class="token plain"> </span><span class="token operator" style="color:#f76191">=</span><span class="token plain"> </span><span class="token maybe-class-name">Java</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">use</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&#x27;android.view.Window&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">12</span><span class="token plain">    </span><span class="token keyword" style="color:#f76191">var</span><span class="token plain"> set_flags </span><span class="token operator" style="color:#f76191">=</span><span class="token plain"> </span><span class="token dom variable">window</span><span class="token punctuation">.</span><span class="token property-access">setFlags</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">overload</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&#x27;int&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string" style="color:#0ac5b2">&#x27;int&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">13</span><span class="token plain" style="display:inline-block">
</span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">14</span><span class="token plain">    </span><span class="token keyword" style="color:#f76191">var</span><span class="token plain"> window_manager </span><span class="token operator" style="color:#f76191">=</span><span class="token plain"> </span><span class="token maybe-class-name">Java</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">use</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&#x27;android.view.WindowManager&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">15</span><span class="token plain">    </span><span class="token keyword" style="color:#f76191">var</span><span class="token plain"> layout_params </span><span class="token operator" style="color:#f76191">=</span><span class="token plain"> </span><span class="token maybe-class-name">Java</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">use</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&#x27;android.view.WindowManager$LayoutParams&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">16</span><span class="token plain" style="display:inline-block">
</span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">17</span><span class="token plain">    set_flags</span><span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access" style="color:#52a9ff">implementation</span><span class="token plain"> </span><span class="token operator" style="color:#f76191">=</span><span class="token plain"> </span><span class="token keyword" style="color:#f76191">function</span><span class="token punctuation">(</span><span class="token parameter">flags</span><span class="token parameter punctuation">,</span><span class="token parameter"> mask</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">18</span><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">log</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&quot;flag secure: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#f76191">+</span><span class="token plain"> layout_params</span><span class="token punctuation">.</span><span class="token constant" style="color:#0ac5b2">FLAG_SECURE</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">19</span><span class="token plain" style="display:inline-block">
</span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">20</span><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">log</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&quot;before setflags called  flags:  &quot;</span><span class="token operator" style="color:#f76191">+</span><span class="token plain"> flags</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">21</span><span class="token plain">        flags </span><span class="token operator" style="color:#f76191">=</span><span class="token punctuation">(</span><span class="token plain">flags</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token plain"> </span><span class="token operator" style="color:#f76191">&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#f76191">~</span><span class="token plain">layout_params</span><span class="token punctuation">.</span><span class="token constant" style="color:#0ac5b2">FLAG_SECURE</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">22</span><span class="token plain">        </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">log</span><span class="token punctuation">(</span><span class="token string" style="color:#0ac5b2">&quot;after setflags called  flags:  &quot;</span><span class="token operator" style="color:#f76191">+</span><span class="token plain"> flags</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">23</span><span class="token plain" style="display:inline-block">
</span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">24</span><span class="token plain">        set_flags</span><span class="token punctuation">.</span><span class="token method function property-access" style="color:#52a9ff">call</span><span class="token punctuation">(</span><span class="token keyword" style="color:#f76191">this</span><span class="token punctuation">,</span><span class="token plain"> flags</span><span class="token punctuation">,</span><span class="token plain"> mask</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">25</span><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span>
</span><span class="px-5 h-5 block"><span class="pr-4 select-none opacity-50 text-right">26</span><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre><button class="absolute top-3.5 right-3.5 overflow-hidden rounded-[5px] flex justify-center items-center w-8 h-8 font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 hover:bg-[#1f1f1f] hover:text-[#a0a0a0]"><svg fill="none" height="20" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="20" class="pointer-events-none flex items-center gap-0.5 transition duration-300"><path d="M6 17C4.89543 17 4 16.1046 4 15V5C4 3.89543 4.89543 3 6 3H13C13.7403 3 14.3866 3.4022 14.7324 4M11 21H18C19.1046 21 20 20.1046 20 19V9C20 7.89543 19.1046 7 18 7H11C9.89543 7 9 7.89543 9 9V19C9 20.1046 9.89543 21 11 21Z"></path></svg><svg fill="none" height="20" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="20" class="pointer-events-none flex items-center absolute transition duration-300 translate-y-1.5 opacity-0"><path d="M20 6L9 17l-5-5"></path></svg></button></div></div><p>Essa abordagem demonstra uma possível vulnerabilidade em relação à <strong><code>FLAG_SECURE</code></strong>, mas é importante ressaltar que a proteção oferecida por essa configuração é eficaz na maioria dos casos e desencoraja a captura e o compartilhamento não autorizados de conteúdo sensível.</p><h2 id="praticas-recomendadas-e-mitigacao">Práticas Recomendadas e Mitigação</h2><p>Para mitigar as vulnerabilidades relacionadas à <strong><code>FLAG_SECURE</code></strong> e garantir uma proteção adequada do conteúdo sensível, aqui estão algumas práticas recomendadas:</p><ul><li>Verifique se a configuração global <strong><code>secure</code></strong> está definida como verdadeira. Isso pode ser feito usando o método <strong><code>Secure.getInt()</code></strong> para obter o valor da configuração e verificar se está definido como <strong>1</strong>;</li><li>Monitore as propriedades do sistema, como <strong><code>secure</code></strong> e <strong><code>ro.debuggable</code></strong>, para verificar se estão definidas corretamente. Valores incorretos podem indicar que o <strong><code>FLAG_SECURE</code></strong> não está configurado adequadamente;</li><li>Verifique se a assinatura do pacote do aplicativo corresponde à assinatura esperada. Se a assinatura for diferente, isso pode indicar que o aplicativo foi modificado para desativar o <strong><code>FLAG_SECURE</code></strong>;</li><li>Analise o arquivo xml do aplicativo para verificar se a flag <strong><code>android:debuggable</code></strong> está definida como <strong>false</strong>. A definição dessa flag como <strong>true</strong> pode indicar uma configuração insegura;</li><li>Monitore o comportamento do aplicativo em tempo de execução em busca de comportamentos incomuns, como o uso de APIs de depuração, acesso não autorizado a recursos protegidos ou acesso a informações sensíveis;</li><li>Implemente testes de integridade no aplicativo para detectar modificações ou manipulações no código em tempo de execução. Isso pode envolver a verificação de hashes de arquivos relevantes ou a comparação de versões do aplicativo.</li></ul><h2 id="conclusao">Conclusão</h2><p>A flag <strong><code>FLAG_SECURE</code></strong> é uma medida de segurança essencial para proteger o conteúdo sensível em aplicativos Android. Implementar essa configuração adequadamente e adotar as práticas recomendadas de mitigação ajudará a garantir a privacidade e a segurança dos usuários. No entanto, é importante estar ciente de que nenhuma proteção é absoluta, e abordagens como o uso do Frida Tools podem contornar a <strong><code>FLAG_SECURE</code></strong> em certos casos. Portanto, é fundamental adotar uma abordagem abrangente de segurança, combinando várias camadas de proteção para garantir a integridade do aplicativo e a privacidade dos usuários.</p><h2 id="referencias">Referências</h2><p><a href="https://developer.android.com/topic/security/best-practices?hl=pt-br">Android - Práticas recomendadas para segurança de <em>apps</em><span class="inline-flex"><svg data-testid="geist-icon" fill="none" height="14" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="14" class="text-current"><path d="M7 17L17 7"></path><path d="M7 7h10v10"></path></svg></span></a></p><p><a href="https://developer.android.com/reference/android/view/WindowManager.LayoutParams#FLAG_LAYOUT_IN_SCREEN">Android - WindowManager.LayoutParams<span class="inline-flex"><svg data-testid="geist-icon" fill="none" height="14" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="14" class="text-current"><path d="M7 17L17 7"></path><path d="M7 7h10v10"></path></svg></span></a></p><p><a href="https://github.com/commonsguy/cwac-security/blob/master/docs/FLAGSECURE.md">GitHub - About the FLAG_SECURE Child Window Issue<span class="inline-flex"><svg data-testid="geist-icon" fill="none" height="14" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="14" class="text-current"><path d="M7 17L17 7"></path><path d="M7 7h10v10"></path></svg></span></a></p><p><a href="http://www.java2s.com/example/android/user-interface/set-flag-secure.html">Java2s - set Flag Secure - Android User Interface<span class="inline-flex"><svg data-testid="geist-icon" fill="none" height="14" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="14" class="text-current"><path d="M7 17L17 7"></path><path d="M7 7h10v10"></path></svg></span></a></p></article></div><nav class="w-56 shrink-0 hidden lg:block"><div class="hidden lg:block sticky top-[126px] overflow-y-auto" data-docs-crowler="true"><h2 class="mb-1 mt-[7px] text-sm font-medium text-white">Nessa página</h2><ul class="mt-4 space-y-3 text-sm"><li><a href="#flag-secure" class="block leading-[1.6] font-medium text-blue-500">Flag Secure</a></li><li><a href="#prefacio" class="block text-[#888] hover:text-[#999] leading-[1.6]">Prefácio</a></li><li><a href="#importancia-da-flag-secure" class="block text-[#888] hover:text-[#999] leading-[1.6]">Importância da Flag Secure</a></li><li><a href="#owasp-id" class="block text-[#888] hover:text-[#999] leading-[1.6]">OWASP ID</a></li><li><a href="#implementando-a-flag-secure" class="block text-[#888] hover:text-[#999] leading-[1.6]">Implementando a Flag Secure</a></li><li><a href="#bypass-da-flag-secure-com-frida-tools" class="block text-[#888] hover:text-[#999] leading-[1.6]">Bypass da Flag Secure com Frida Tools</a></li><li><a href="#praticas-recomendadas-e-mitigacao" class="block text-[#888] hover:text-[#999] leading-[1.6]">Práticas Recomendadas e Mitigação</a></li><li><a href="#conclusao" class="block text-[#888] hover:text-[#999] leading-[1.6]">Conclusão</a></li><li><a href="#referencias" class="block text-[#888] hover:text-[#999] leading-[1.6]">Referências</a></li></ul><div class="mt-4 space-y-2 border-t border-[#444] pt-5 text-sm"></div><button class="flex items-center gap-x-2 text-sm text-[#888] transition-opacity hover:text-white opacity-0"><svg fill="none" height="14" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewBox="0 0 24 24" width="14" class="text-current"><circle cx="12" cy="12" r="10"></circle><path d="M16 12l-4-4-4 4"></path><path d="M12 16V8"></path></svg>Scroll to top</button></div></nav></div></main><footer class="bg-[#111] border-y border-[#333]"><div><div class="flex justify-center gap-3 items-center w-full my-8 mb-12"><img src="/_next/static/media/logo_white.35709e9b.png" alt="Logo" style="max-width:40px;max-height:100px"/><p class="text-xs text-[#888]">Copyright © <!-- -->2023<!-- -->  <a class="text-blue-500 font-bold no-underline" href="https://github.com/kiritorce">Kirito</a></p></div></div></footer><script src="/_next/static/chunks/webpack-b436426dcbaf52c9.js" async=""></script><script src="/_next/static/chunks/fd9d1056-cf2ed9b9f252c563.js" async=""></script><script src="/_next/static/chunks/596-48ba4ae402e6d185.js" async=""></script><script src="/_next/static/chunks/main-app-a51e70cdc63efed3.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/2aaf0723e720e8b9-s.p.woff2\",{\"as\":\"font\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/css/ec2c95c4a0b5aeac.css\",{\"as\":\"style\"}]\n0:\"$L3\"\n"])</script><script>self.__next_f.push([1,"4:I{\"id\":7948,\"chunks\":[\"272:static/chunks/webpack-b436426dcbaf52c9.js\",\"971:static/chunks/fd9d1056-cf2ed9b9f252c563.js\",\"596:static/chunks/596-48ba4ae402e6d185.js\"],\"name\":\"default\",\"async\":false}\n6:I{\"id\":6628,\"chunks\":[\"272:static/chunks/webpack-b436426dcbaf52c9.js\",\"971:static/chunks/fd9d1056-cf2ed9b9f252c563.js\",\"596:static/chunks/596-48ba4ae402e6d185.js\"],\"name\":\"GlobalError\",\"async\":false}\n9:I{\"id\":2648,\"chunks\":[\"336:static/chunks/336-80894123ddb06d86.js\",\"648:static/chunks/648-20ce7a2bd0908fd0.js\","])</script><script>self.__next_f.push([1,"\"185:static/chunks/app/layout-4aadab169859256e.js\"],\"name\":\"WikiProvider\",\"async\":false}\na:I{\"id\":9417,\"chunks\":[\"336:static/chunks/336-80894123ddb06d86.js\",\"648:static/chunks/648-20ce7a2bd0908fd0.js\",\"185:static/chunks/app/layout-4aadab169859256e.js\"],\"name\":\"SearchProvider\",\"async\":false}\nb:I{\"id\":1350,\"chunks\":[\"336:static/chunks/336-80894123ddb06d86.js\",\"648:static/chunks/648-20ce7a2bd0908fd0.js\",\"877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js\"],\"name\":\"Navbar\",\"async\":false}\nc:I{\"id\":7767,\"ch"])</script><script>self.__next_f.push([1,"unks\":[\"272:static/chunks/webpack-b436426dcbaf52c9.js\",\"971:static/chunks/fd9d1056-cf2ed9b9f252c563.js\",\"596:static/chunks/596-48ba4ae402e6d185.js\"],\"name\":\"default\",\"async\":false}\nd:I{\"id\":7920,\"chunks\":[\"272:static/chunks/webpack-b436426dcbaf52c9.js\",\"971:static/chunks/fd9d1056-cf2ed9b9f252c563.js\",\"596:static/chunks/596-48ba4ae402e6d185.js\"],\"name\":\"default\",\"async\":false}\n"])</script><script>self.__next_f.push([1,"3:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/ec2c95c4a0b5aeac.css\",\"precedence\":\"next\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"TmpMQv2BparyZL1Mlwt5A\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/mobile/protections/secure_flag\",\"initialTree\":[\"\",{\"children\":[[\"slug\",\"mobile/protections/secure_flag\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"mobile\\\",\\\"protections\\\",\\\"secure_flag\\\"]}\",{}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":\"$L5\",\"globalErrorComponent\":\"$6\",\"notFound\":[\"$\",\"html\",null,{\"id\":\"__next_error__\",\"children\":[[\"$\",\"head\",null,{\"children\":\"$undefined\"}],[\"$\",\"body\",null,{\"children\":[\"$L7\",[],\"$L8\"]}]]}],\"asNotFound\":false,\"children\":[[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"__className_20951f\",\"style\":{\"colorScheme\":\"dark\"},\"children\":[\"$\",\"body\",null,{\"className\":\"bg-black\",\"children\":[\"$\",\"$L9\",null,{\"children\":[\"$\",\"$La\",null,{\"children\":[[\"$\",\"$Lb\",null,{}],[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Ld\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$Lc\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",[\"slug\",\"mobile/protections/secure_flag\",\"c\"],\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"template\":[\"$\",\"$Ld\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$Le\",\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$Lf\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":[\\\"mobile\\\",\\\"protections\\\",\\\"secure_flag\\\"]}\"},\"styles\":[]}],\"segment\":[\"slug\",\"mobile/protections/secure_flag\",\"c\"]},\"styles\":[]}],[\"$\",\"footer\",null,{\"className\":\"bg-[#111] border-y border-[#333]\",\"children\":[\"$\",\"div\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"flex justify-center gap-3 items-center w-full my-8 mb-12\",\"children\":[[\"$\",\"img\",null,{\"src\":\"/_next/static/media/logo_white.35709e9b.png\",\"alt\":\"Logo\",\"style\":{\"maxWidth\":\"40px\",\"maxHeight\":\"100px\"}}],[\"$\",\"p\",null,{\"className\":\"text-xs text-[#888]\",\"children\":[\"Copyright © \",2023,\"  \",[\"$\",\"a\",null,{\"className\":\"text-blue-500 font-bold no-underline\",\"href\":\"https://github.com/kiritorce\",\"children\":\"Kirito\"}]]}]]}]}]}]]}]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"10:I{\"id\":6716,\"chunks\":[\"336:static/chunks/336-80894123ddb06d86.js\",\"648:static/chunks/648-20ce7a2bd0908fd0.js\",\"877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js\"],\"name\":\"MobileSidebar\",\"async\":false}\n11:I{\"id\":8836,\"chunks\":[\"336:static/chunks/336-80894123ddb06d86.js\",\"648:static/chunks/648-20ce7a2bd0908fd0.js\",\"877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js\"],\"name\":\"SearchDialog\",\"async\":false}\n12:I{\"id\":3406,\"chunks\":[\"336:static/chunks/336-80894123ddb06d86.js\",\"648:static/chunks/648"])</script><script>self.__next_f.push([1,"-20ce7a2bd0908fd0.js\",\"877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js\"],\"name\":\"Sidebar\",\"async\":false}\n13:I{\"id\":183,\"chunks\":[\"336:static/chunks/336-80894123ddb06d86.js\",\"648:static/chunks/648-20ce7a2bd0908fd0.js\",\"877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js\"],\"name\":\"Fence\",\"async\":false}\n14:I{\"id\":7593,\"chunks\":[\"336:static/chunks/336-80894123ddb06d86.js\",\"648:static/chunks/648-20ce7a2bd0908fd0.js\",\"877:static/chunks/app/[...slug]/page-2bc84a6b6bee8dd1.js\"],\"name\":\"TableOfContents"])</script><script>self.__next_f.push([1,"\",\"async\":false}\n8:[\"$\",\"div\",null,{\"className\":\"flex justify-center items-center text-white h-[calc(100vh-64px)]\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-2xl sm:text-3xl font-extrabold text-white tracking-tight sm:pr-6 sm:mr-6 sm:border-r sm:border-[#333]\",\"children\":\"404\"}],[\"$\",\"h2\",null,{\"className\":\"text-lg\",\"children\":\"This page could not be found.\"}]]}]\ne:[\"$\",\"div\",null,{\"className\":\"flex justify-center items-center text-white h-[calc(100vh-64px)]\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text"])</script><script>self.__next_f.push([1,"-2xl sm:text-3xl font-extrabold text-white tracking-tight sm:pr-6 sm:mr-6 sm:border-r sm:border-[#333]\",\"children\":\"404\"}],[\"$\",\"h2\",null,{\"className\":\"text-lg\",\"children\":\"This page could not be found.\"}]]}]\n"])</script><script>self.__next_f.push([1,"f:[\"$\",\"main\",null,{\"children\":[[\"$\",\"$L10\",null,{}],[\"$\",\"div\",null,{\"className\":\"py-10 relative md:flex md:py-10 gap-x-6 mx-auto md:flex-row max-w-screen-xl px-4 md:px-0\",\"children\":[[\"$\",\"$L11\",null,{}],[\"$\",\"$L12\",null,{}],[\"$\",\"div\",null,{\"className\":\"prose prose-invert w-full min-w-0 max-w-6xl custom-li\",\"children\":[\"$\",\"article\",null,{\"children\":[[\"$\",\"h1\",null,{\"id\":\"flag-secure\",\"children\":\"Flag Secure\"}],[\"$\",\"h2\",null,{\"id\":\"prefacio\",\"children\":\"Prefácio\"}],[\"$\",\"p\",null,{\"children\":[\"A flag \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" é uma configuração importante no Android que ajuda a proteger o conteúdo sensível da tela em aplicativos. Quando uma atividade é marcada com essa flag, o sistema operacional adota medidas de segurança adicionais para evitar que o conteúdo da tela seja capturado por meio de screenshots ou gravado em vídeos. Além disso, impede que o conteúdo seja exibido em dispositivos externos, como monitores ou projetores, que não são considerados seguros pelo sistema.\"]}],[\"$\",\"h2\",null,{\"id\":\"importancia-da-flag-secure\",\"children\":\"Importância da Flag Secure\"}],[\"$\",\"p\",null,{\"children\":[\"A proteção do conteúdo sensível em aplicativos é crucial para garantir a privacidade e a segurança dos usuários. Ao utilizar a flag \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\", você pode evitar que informações confidenciais, como senhas, dados bancários e informações de autenticação, sejam comprometidas. Isso é especialmente relevante em aplicativos que lidam com dados sensíveis.\"]}],[\"$\",\"h2\",null,{\"id\":\"owasp-id\",\"children\":\"OWASP ID\"}],[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication\",\"children\":[\"OWASP-MOBILE-2016 - M4: Insecure Authentication\",[\"$\",\"span\",null,{\"className\":\"inline-flex\",\"children\":[\"$\",\"svg\",null,{\"data-testid\":\"geist-icon\",\"fill\":\"none\",\"height\":\"14\",\"shapeRendering\":\"geometricPrecision\",\"stroke\":\"currentColor\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"strokeWidth\":\"1.5\",\"viewBox\":\"0 0 24 24\",\"width\":\"14\",\"className\":\"text-current\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M7 17L17 7\"}],[\"$\",\"path\",null,{\"d\":\"M7 7h10v10\"}]]}]}]]}]}],[\"$\",\"h2\",null,{\"id\":\"implementando-a-flag-secure\",\"children\":\"Implementando a Flag Secure\"}],[\"$\",\"p\",null,{\"children\":[\"Existem duas maneiras principais de implementar a \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" em um aplicativo Android:\"]}],[\"$\",\"ol\",null,{\"children\":[\"$\",\"li\",null,{\"children\":[\"No Manifest.xml:\",\" \",\"Você pode definir o atributo \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"android:windowSecure\"}]}],\" como \",[\"$\",\"strong\",null,{\"children\":\"true\"}],\" no elemento \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"\u003cactivity\u003e\"}]}],\" do arquivo \",[\"$\",\"strong\",null,{\"children\":\"Manifest.xml\"}],\" para todas as atividades do seu aplicativo. Dessa forma, a flag \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" será aplicada automaticamente a todas as atividades.\"]}]}],[\"$\",\"p\",null,{\"children\":[\"Exemplo \",[\"$\",\"strong\",null,{\"children\":\"Manifest.xml\"}],\":\"]}],[\"$\",\"$L13\",null,{\"language\":\"xml\",\"children\":\"\u003cactivity android:name=\\\".MainActivity\\\"\\n          android:windowSecure=\\\"true\\\"\u003e\\n    ...\\n\u003c/activity\u003e\\n\"}],[\"$\",\"ol\",null,{\"children\":[\"$\",\"li\",null,{\"children\":[\"No código \",[\"$\",\"strong\",null,{\"children\":\"Java/Kotlin\"}],\":\"]}]}],[\"$\",\"p\",null,{\"children\":[\"Você pode usar o método \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"setFlags()\"}]}],\" da classe \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Window\"}]}],\" para definir programaticamente a flag \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" em uma atividade específica.\"]}],[\"$\",\"p\",null,{\"children\":[\"Exemplo \",[\"$\",\"strong\",null,{\"children\":\"Java\"}],\":\"]}],[\"$\",\"$L13\",null,{\"language\":\"java\",\"children\":\"getWindow().setFlags(WindowManager.LayoutParams.FLAG_SECURE, WindowManager.LayoutParams.FLAG_SECURE);\\n\"}],[\"$\",\"p\",null,{\"children\":[\"Exemplo \",[\"$\",\"strong\",null,{\"children\":\"Kotlin\"}],\":\"]}],[\"$\",\"$L13\",null,{\"language\":\"kotlin\",\"children\":\"window.setFlags(WindowManager.LayoutParams.FLAG_SECURE, WindowManager.LayoutParams.FLAG_SECURE)\\n\"}],[\"$\",\"p\",null,{\"children\":\"Normalmente, você chamaria esse método no método onCreate() da sua atividade principal.\"}],[\"$\",\"h2\",null,{\"id\":\"bypass-da-flag-secure-com-frida-tools\",\"children\":\"Bypass da Flag Secure com Frida Tools\"}],[\"$\",\"p\",null,{\"children\":[\"É importante destacar que a \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" não é uma proteção absoluta, e algumas abordagens podem contornar essa configuração. Uma dessas abordagens envolve o uso do Frida Tools, uma ferramenta para manipulação e instrumentação de aplicativos Android.\"]}],[\"$\",\"p\",null,{\"children\":[\"O script abaixo demonstra como realizar o bypass da \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" usando o Frida Tools:\"]}],[\"$\",\"$L13\",null,{\"language\":\"js\",\"children\":\"Java.perform(function() {\\n    var surface_view = Java.use('android.view.SurfaceView');\\n\\n    var set_secure = surface_view.setSecure.overload('boolean');\\n\\n    set_secure.implementation = function(flag){\\n        console.log(\\\"setSecure() flag called with args: \\\" + flag); \\n        set_secure.call(false);\\n    };\\n\\n    var window = Java.use('android.view.Window');\\n    var set_flags = window.setFlags.overload('int', 'int');\\n\\n    var window_manager = Java.use('android.view.WindowManager');\\n    var layout_params = Java.use('android.view.WindowManager$LayoutParams');\\n\\n    set_flags.implementation = function(flags, mask){\\n        console.log(\\\"flag secure: \\\" + layout_params.FLAG_SECURE.value);\\n\\n        console.log(\\\"before setflags called  flags:  \\\"+ flags);\\n        flags =(flags.value \u0026 ~layout_params.FLAG_SECURE.value);\\n        console.log(\\\"after setflags called  flags:  \\\"+ flags);\\n\\n        set_flags.call(this, flags, mask);\\n    };\\n});\\n\"}],[\"$\",\"p\",null,{\"children\":[\"Essa abordagem demonstra uma possível vulnerabilidade em relação à \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\", mas é importante ressaltar que a proteção oferecida por essa configuração é eficaz na maioria dos casos e desencoraja a captura e o compartilhamento não autorizados de conteúdo sensível.\"]}],[\"$\",\"h2\",null,{\"id\":\"praticas-recomendadas-e-mitigacao\",\"children\":\"Práticas Recomendadas e Mitigação\"}],[\"$\",\"p\",null,{\"children\":[\"Para mitigar as vulnerabilidades relacionadas à \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" e garantir uma proteção adequada do conteúdo sensível, aqui estão algumas práticas recomendadas:\"]}],[\"$\",\"ul\",null,{\"children\":[[\"$\",\"li\",null,{\"children\":[\"Verifique se a configuração global \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"secure\"}]}],\" está definida como verdadeira. Isso pode ser feito usando o método \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"Secure.getInt()\"}]}],\" para obter o valor da configuração e verificar se está definido como \",[\"$\",\"strong\",null,{\"children\":\"1\"}],\";\"]}],[\"$\",\"li\",null,{\"children\":[\"Monitore as propriedades do sistema, como \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"secure\"}]}],\" e \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"ro.debuggable\"}]}],\", para verificar se estão definidas corretamente. Valores incorretos podem indicar que o \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" não está configurado adequadamente;\"]}],[\"$\",\"li\",null,{\"children\":[\"Verifique se a assinatura do pacote do aplicativo corresponde à assinatura esperada. Se a assinatura for diferente, isso pode indicar que o aplicativo foi modificado para desativar o \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\";\"]}],[\"$\",\"li\",null,{\"children\":[\"Analise o arquivo xml do aplicativo para verificar se a flag \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"android:debuggable\"}]}],\" está definida como \",[\"$\",\"strong\",null,{\"children\":\"false\"}],\". A definição dessa flag como \",[\"$\",\"strong\",null,{\"children\":\"true\"}],\" pode indicar uma configuração insegura;\"]}],[\"$\",\"li\",null,{\"children\":\"Monitore o comportamento do aplicativo em tempo de execução em busca de comportamentos incomuns, como o uso de APIs de depuração, acesso não autorizado a recursos protegidos ou acesso a informações sensíveis;\"}],[\"$\",\"li\",null,{\"children\":\"Implemente testes de integridade no aplicativo para detectar modificações ou manipulações no código em tempo de execução. Isso pode envolver a verificação de hashes de arquivos relevantes ou a comparação de versões do aplicativo.\"}]]}],[\"$\",\"h2\",null,{\"id\":\"conclusao\",\"children\":\"Conclusão\"}],[\"$\",\"p\",null,{\"children\":[\"A flag \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" é uma medida de segurança essencial para proteger o conteúdo sensível em aplicativos Android. Implementar essa configuração adequadamente e adotar as práticas recomendadas de mitigação ajudará a garantir a privacidade e a segurança dos usuários. No entanto, é importante estar ciente de que nenhuma proteção é absoluta, e abordagens como o uso do Frida Tools podem contornar a \",[\"$\",\"strong\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"FLAG_SECURE\"}]}],\" em certos casos. Portanto, é fundamental adotar uma abordagem abrangente de segurança, combinando várias camadas de proteção para garantir a integridade do aplicativo e a privacidade dos usuários.\"]}],[\"$\",\"h2\",null,{\"id\":\"referencias\",\"children\":\"Referências\"}],[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://developer.android.com/topic/security/best-practices?hl=pt-br\",\"children\":[[\"Android - Práticas recomendadas para segurança de \",[\"$\",\"em\",null,{\"children\":\"apps\"}]],[\"$\",\"span\",null,{\"className\":\"inline-flex\",\"children\":[\"$\",\"svg\",null,{\"data-testid\":\"geist-icon\",\"fill\":\"none\",\"height\":\"14\",\"shapeRendering\":\"geometricPrecision\",\"stroke\":\"currentColor\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"strokeWidth\":\"1.5\",\"viewBox\":\"0 0 24 24\",\"width\":\"14\",\"className\":\"text-current\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M7 17L17 7\"}],[\"$\",\"path\",null,{\"d\":\"M7 7h10v10\"}]]}]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://developer.android.com/reference/android/view/WindowManager.LayoutParams#FLAG_LAYOUT_IN_SCREEN\",\"children\":[\"Android - WindowManager.LayoutParams\",[\"$\",\"span\",null,{\"className\":\"inline-flex\",\"children\":[\"$\",\"svg\",null,{\"data-testid\":\"geist-icon\",\"fill\":\"none\",\"height\":\"14\",\"shapeRendering\":\"geometricPrecision\",\"stroke\":\"currentColor\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"strokeWidth\":\"1.5\",\"viewBox\":\"0 0 24 24\",\"width\":\"14\",\"className\":\"text-current\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M7 17L17 7\"}],[\"$\",\"path\",null,{\"d\":\"M7 7h10v10\"}]]}]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/commonsguy/cwac-security/blob/master/docs/FLAGSECURE.md\",\"children\":[\"GitHub - About the FLAG_SECURE Child Window Issue\",[\"$\",\"span\",null,{\"className\":\"inline-flex\",\"children\":[\"$\",\"svg\",null,{\"data-testid\":\"geist-icon\",\"fill\":\"none\",\"height\":\"14\",\"shapeRendering\":\"geometricPrecision\",\"stroke\":\"currentColor\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"strokeWidth\":\"1.5\",\"viewBox\":\"0 0 24 24\",\"width\":\"14\",\"className\":\"text-current\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M7 17L17 7\"}],[\"$\",\"path\",null,{\"d\":\"M7 7h10v10\"}]]}]}]]}]}],[\"$\",\"p\",null,{\"children\":[\"$\",\"a\",null,{\"href\":\"http://www.java2s.com/example/android/user-interface/set-flag-secure.html\",\"children\":[\"Java2s - set Flag Secure - Android User Interface\",[\"$\",\"span\",null,{\"className\":\"inline-flex\",\"children\":[\"$\",\"svg\",null,{\"data-testid\":\"geist-icon\",\"fill\":\"none\",\"height\":\"14\",\"shapeRendering\":\"geometricPrecision\",\"stroke\":\"currentColor\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"strokeWidth\":\"1.5\",\"viewBox\":\"0 0 24 24\",\"width\":\"14\",\"className\":\"text-current\",\"children\":[[\"$\",\"path\",null,{\"d\":\"M7 17L17 7\"}],[\"$\",\"path\",null,{\"d\":\"M7 7h10v10\"}]]}]}]]}]}]]}]}],[\"$\",\"$L14\",null,{\"headings\":[{\"id\":\"flag-secure\",\"title\":\"Flag Secure\",\"children\":[]},{\"id\":\"prefacio\",\"title\":\"Prefácio\",\"children\":[]},{\"id\":\"importancia-da-flag-secure\",\"title\":\"Importância da Flag Secure\",\"children\":[]},{\"id\":\"owasp-id\",\"title\":\"OWASP ID\",\"children\":[]},{\"id\":\"implementando-a-flag-secure\",\"title\":\"Implementando a Flag Secure\",\"children\":[]},{\"id\":\"bypass-da-flag-secure-com-frida-tools\",\"title\":\"Bypass da Flag Secure com Frida Tools\",\"children\":[]},{\"id\":\"praticas-recomendadas-e-mitigacao\",\"title\":\"Práticas Recomendadas e Mitigação\",\"children\":[]},{\"id\":\"conclusao\",\"title\":\"Conclusão\",\"children\":[]},{\"id\":\"referencias\",\"title\":\"Referências\",\"children\":[]}]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"5:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Docs | Kirito\"}],[\"$\",\"meta\",\"2\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/logo/logo_green.png\"}],[\"$\",\"meta\",\"4\",{\"name\":\"next-size-adjust\"}]]\n7:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Docs | Kirito\"}],[\"$\",\"meta\",\"2\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/logo/logo_green.png\"}"])</script><script>self.__next_f.push([1,"],[\"$\",\"meta\",\"4\",{\"name\":\"next-size-adjust\"}]]\n"])</script></body></html>